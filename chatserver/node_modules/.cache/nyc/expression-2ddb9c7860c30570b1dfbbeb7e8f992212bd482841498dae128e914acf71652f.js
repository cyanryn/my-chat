function cov_1flojl52bk(){var path="D:\\repository\\mychat\\chatserver\\controller\\expression.js";var hash="761df43005db74a85dac373e17df31d55c74ade3";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"D:\\repository\\mychat\\chatserver\\controller\\expression.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:30}},"1":{start:{line:4,column:4},end:{line:4,column:34}},"2":{start:{line:4,column:24},end:{line:4,column:34}},"3":{start:{line:5,column:16},end:{line:24,column:6}},"4":{start:{line:25,column:4},end:{line:25,column:69}},"5":{start:{line:25,column:28},end:{line:25,column:69}},"6":{start:{line:26,column:4},end:{line:38,column:5}},"7":{start:{line:27,column:32},end:{line:27,column:66}},"8":{start:{line:28,column:21},end:{line:28,column:56}},"9":{start:{line:30,column:23},end:{line:30,column:33}},"10":{start:{line:31,column:8},end:{line:35,column:12}},"11":{start:{line:31,column:64},end:{line:35,column:9}},"12":{start:{line:37,column:8},end:{line:37,column:41}},"13":{start:{line:40,column:4},end:{line:40,column:14}},"14":{start:{line:43,column:0},end:{line:45,column:1}}},fnMap:{"0":{name:"getExpression",decl:{start:{line:3,column:15},end:{line:3,column:28}},loc:{start:{line:3,column:38},end:{line:41,column:1}},line:3},"1":{name:"(anonymous_1)",decl:{start:{line:31,column:26},end:{line:31,column:27}},loc:{start:{line:31,column:64},end:{line:35,column:9}},line:31}},branchMap:{"0":{loc:{start:{line:4,column:4},end:{line:4,column:34}},type:"if",locations:[{start:{line:4,column:4},end:{line:4,column:34}},{start:{line:4,column:4},end:{line:4,column:34}}],line:4},"1":{loc:{start:{line:25,column:4},end:{line:25,column:69}},type:"if",locations:[{start:{line:25,column:4},end:{line:25,column:69}},{start:{line:25,column:4},end:{line:25,column:69}}],line:25}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"761df43005db74a85dac373e17df31d55c74ade3"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_1flojl52bk=function(){return actualCoverage;};return actualCoverage;}cov_1flojl52bk();const axios=(cov_1flojl52bk().s[0]++,require("axios"));async function getExpression(keyword){cov_1flojl52bk().f[0]++;cov_1flojl52bk().s[1]++;if(keyword===''){cov_1flojl52bk().b[0][0]++;cov_1flojl52bk().s[2]++;return[];}else{cov_1flojl52bk().b[0][1]++;}const res=(cov_1flojl52bk().s[3]++,await axios({method:'get',url:`https://pic.sogou.com/pics/json.jsp?query=${encodeURIComponent(`${keyword} 表情`)}&st=5&start=0&xml_len=60&callback=callback&reqFrom=wap_result&`,headers:{accept:'*/*','accept-language':'zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7','cache-control':'no-cache',pragma:'no-cache','sec-fetch-mode':'navigate','sec-fetch-site':'same-origin',referrer:`https://pic.sogou.com/pic/emo/searchList.jsp?statref=search_form&uID=hTHHybkSPt37C46z&spver=0&rcer=&keyword=${encodeURIComponent(keyword)}`,referrerPolicy:'no-referrer-when-downgrade','user-agent':'Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1'}}));cov_1flojl52bk().s[4]++;if(res.status!==200){cov_1flojl52bk().b[1][0]++;cov_1flojl52bk().s[5]++;return{status:400,msg:'搜索表情包失败, 请重试'};}else{cov_1flojl52bk().b[1][1]++;}cov_1flojl52bk().s[6]++;try{const parseDataResult=(cov_1flojl52bk().s[7]++,res.data.match(/callback\((.+)\)/));const data=(cov_1flojl52bk().s[8]++,JSON.parse(`${parseDataResult[1]}`));const images=(cov_1flojl52bk().s[9]++,data.items);cov_1flojl52bk().s[10]++;return images.map(({locImageLink,width,height})=>{cov_1flojl52bk().f[1]++;cov_1flojl52bk().s[11]++;return{image:locImageLink,width,height};});}catch(err){cov_1flojl52bk().s[12]++;assert(false,'搜索表情包失败, 数据解析异常');}cov_1flojl52bk().s[13]++;return[];}cov_1flojl52bk().s[14]++;module.exports={getExpression};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4cHJlc3Npb24uanMiXSwibmFtZXMiOlsiYXhpb3MiLCJyZXF1aXJlIiwiZ2V0RXhwcmVzc2lvbiIsImtleXdvcmQiLCJyZXMiLCJtZXRob2QiLCJ1cmwiLCJlbmNvZGVVUklDb21wb25lbnQiLCJoZWFkZXJzIiwiYWNjZXB0IiwicHJhZ21hIiwicmVmZXJyZXIiLCJyZWZlcnJlclBvbGljeSIsInN0YXR1cyIsIm1zZyIsInBhcnNlRGF0YVJlc3VsdCIsImRhdGEiLCJtYXRjaCIsIkpTT04iLCJwYXJzZSIsImltYWdlcyIsIml0ZW1zIiwibWFwIiwibG9jSW1hZ2VMaW5rIiwid2lkdGgiLCJoZWlnaHQiLCJpbWFnZSIsImVyciIsImFzc2VydCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJveEVBQUEsS0FBTUEsQ0FBQUEsS0FBSywwQkFBR0MsT0FBTyxDQUFDLE9BQUQsQ0FBVixDQUFYLENBRUEsY0FBZUMsQ0FBQUEsYUFBZixDQUE2QkMsT0FBN0IsQ0FBc0MsaURBQ2xDLEdBQUlBLE9BQU8sR0FBSyxFQUFoQixDQUFvQiwwREFBTyxFQUFQLENBQVUsQ0FBOUIsaUNBQ0EsS0FBTUMsQ0FBQUEsR0FBRywwQkFBRyxLQUFNSixDQUFBQSxLQUFLLENBQUMsQ0FDcEJLLE1BQU0sQ0FBRSxLQURZLENBRXBCQyxHQUFHLENBQUcsNkNBQTRDQyxrQkFBa0IsQ0FDL0QsR0FBRUosT0FBUSxLQURxRCxDQUVsRSxnRUFKa0IsQ0FLcEJLLE9BQU8sQ0FBRSxDQUNMQyxNQUFNLENBQUUsS0FESCxDQUVMLGtCQUFtQixxQ0FGZCxDQUdMLGdCQUFpQixVQUhaLENBSUxDLE1BQU0sQ0FBRSxVQUpILENBS0wsaUJBQWtCLFVBTGIsQ0FNTCxpQkFBa0IsYUFOYixDQU9MQyxRQUFRLENBQUcsK0dBQThHSixrQkFBa0IsQ0FDdklKLE9BRHVJLENBRXpJLEVBVEcsQ0FVTFMsY0FBYyxDQUFFLDRCQVZYLENBV0wsYUFDSSx5SUFaQyxDQUxXLENBQUQsQ0FBZCxDQUFULENBRmtDLHdCQXNCbEMsR0FBSVIsR0FBRyxDQUFDUyxNQUFKLEdBQWUsR0FBbkIsQ0FBd0IsMERBQU8sQ0FBQ0EsTUFBTSxDQUFFLEdBQVQsQ0FBY0MsR0FBRyxDQUFFLGNBQW5CLENBQVAsQ0FBeUMsQ0FBakUsaUNBdEJrQyx3QkF1QmxDLEdBQUksQ0FDQSxLQUFNQyxDQUFBQSxlQUFlLDBCQUFHWCxHQUFHLENBQUNZLElBQUosQ0FBU0MsS0FBVCxDQUFlLGtCQUFmLENBQUgsQ0FBckIsQ0FDQSxLQUFNRCxDQUFBQSxJQUFJLDBCQUFHRSxJQUFJLENBQUNDLEtBQUwsQ0FBWSxHQUFFSixlQUFlLENBQUMsQ0FBRCxDQUFJLEVBQWpDLENBQUgsQ0FBVixDQUVBLEtBQU1LLENBQUFBLE1BQU0sMEJBQUdKLElBQUksQ0FBQ0ssS0FBUixDQUFaLENBSkEseUJBS0EsTUFBT0QsQ0FBQUEsTUFBTSxDQUFDRSxHQUFQLENBQVcsQ0FBQyxDQUFFQyxZQUFGLENBQWdCQyxLQUFoQixDQUF1QkMsTUFBdkIsQ0FBRCxHQUFzQyx5REFDcERDLEtBQUssQ0FBRUgsWUFENkMsQ0FFcERDLEtBRm9ELENBR3BEQyxNQUhvRCxFQUl2RCxDQUpNLENBQVAsQ0FLSCxDQUFDLE1BQU9FLEdBQVAsQ0FBWSwwQkFDVkMsTUFBTSxDQUFDLEtBQUQsQ0FBUSxpQkFBUixDQUFOLENBQ0gsQ0FuQ2lDLHlCQXFDbEMsTUFBTyxFQUFQLENBQ0gsQyx5QkFFREMsTUFBTSxDQUFDQyxPQUFQLENBQWlCLENBQ2I1QixhQURhLENBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgYXhpb3MgPSByZXF1aXJlKFwiYXhpb3NcIik7XHJcblxyXG5hc3luYyBmdW5jdGlvbiBnZXRFeHByZXNzaW9uKGtleXdvcmQpIHtcclxuICAgIGlmIChrZXl3b3JkID09PSAnJykgcmV0dXJuIFtdO1xyXG4gICAgY29uc3QgcmVzID0gYXdhaXQgYXhpb3Moe1xyXG4gICAgICAgIG1ldGhvZDogJ2dldCcsXHJcbiAgICAgICAgdXJsOiBgaHR0cHM6Ly9waWMuc29nb3UuY29tL3BpY3MvanNvbi5qc3A/cXVlcnk9JHtlbmNvZGVVUklDb21wb25lbnQoXHJcbiAgICAgICAgICAgIGAke2tleXdvcmR9IOihqOaDhWAsXHJcbiAgICAgICAgKX0mc3Q9NSZzdGFydD0wJnhtbF9sZW49NjAmY2FsbGJhY2s9Y2FsbGJhY2smcmVxRnJvbT13YXBfcmVzdWx0JmAsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICBhY2NlcHQ6ICcqLyonLFxyXG4gICAgICAgICAgICAnYWNjZXB0LWxhbmd1YWdlJzogJ3poLUNOLHpoO3E9MC45LGVuO3E9MC44LHpoLVRXO3E9MC43JyxcclxuICAgICAgICAgICAgJ2NhY2hlLWNvbnRyb2wnOiAnbm8tY2FjaGUnLFxyXG4gICAgICAgICAgICBwcmFnbWE6ICduby1jYWNoZScsXHJcbiAgICAgICAgICAgICdzZWMtZmV0Y2gtbW9kZSc6ICduYXZpZ2F0ZScsXHJcbiAgICAgICAgICAgICdzZWMtZmV0Y2gtc2l0ZSc6ICdzYW1lLW9yaWdpbicsXHJcbiAgICAgICAgICAgIHJlZmVycmVyOiBgaHR0cHM6Ly9waWMuc29nb3UuY29tL3BpYy9lbW8vc2VhcmNoTGlzdC5qc3A/c3RhdHJlZj1zZWFyY2hfZm9ybSZ1SUQ9aFRISHlia1NQdDM3QzQ2eiZzcHZlcj0wJnJjZXI9JmtleXdvcmQ9JHtlbmNvZGVVUklDb21wb25lbnQoXHJcbiAgICAgICAgICAgICAgICBrZXl3b3JkLFxyXG4gICAgICAgICAgICApfWAsXHJcbiAgICAgICAgICAgIHJlZmVycmVyUG9saWN5OiAnbm8tcmVmZXJyZXItd2hlbi1kb3duZ3JhZGUnLFxyXG4gICAgICAgICAgICAndXNlci1hZ2VudCc6XHJcbiAgICAgICAgICAgICAgICAnTW96aWxsYS81LjAgKGlQaG9uZTsgQ1BVIGlQaG9uZSBPUyAxMV8wIGxpa2UgTWFjIE9TIFgpIEFwcGxlV2ViS2l0LzYwNC4xLjM4IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8xMS4wIE1vYmlsZS8xNUEzNzIgU2FmYXJpLzYwNC4xJyxcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIGlmIChyZXMuc3RhdHVzICE9PSAyMDApIHJldHVybiB7c3RhdHVzOiA0MDAsIG1zZzogJ+aQnOe0ouihqOaDheWMheWksei0pSwg6K+36YeN6K+VJ31cclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcGFyc2VEYXRhUmVzdWx0ID0gcmVzLmRhdGEubWF0Y2goL2NhbGxiYWNrXFwoKC4rKVxcKS8pO1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGAke3BhcnNlRGF0YVJlc3VsdFsxXX1gKTtcclxuXHJcbiAgICAgICAgY29uc3QgaW1hZ2VzID0gZGF0YS5pdGVtcztcclxuICAgICAgICByZXR1cm4gaW1hZ2VzLm1hcCgoeyBsb2NJbWFnZUxpbmssIHdpZHRoLCBoZWlnaHQgfSkgPT4gKHtcclxuICAgICAgICAgICAgaW1hZ2U6IGxvY0ltYWdlTGluayxcclxuICAgICAgICAgICAgd2lkdGgsXHJcbiAgICAgICAgICAgIGhlaWdodCxcclxuICAgICAgICB9KSk7XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICBhc3NlcnQoZmFsc2UsICfmkJzntKLooajmg4XljIXlpLHotKUsIOaVsOaNruino+aekOW8guW4uCcpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBbXTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBnZXRFeHByZXNzaW9uXHJcbn1cclxuIl19
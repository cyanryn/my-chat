function cov_lxz1l9gm7(){var path="D:\\repository\\mychat\\chatserver\\app.js";var hash="e12a808a3356b677e1ff0941f4ed1a86921db7fc";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"D:\\repository\\mychat\\chatserver\\app.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:17}},"1":{start:{line:2,column:13},end:{line:2,column:28}},"2":{start:{line:3,column:16},end:{line:3,column:34}},"3":{start:{line:4,column:12},end:{line:4,column:21}},"4":{start:{line:5,column:15},end:{line:5,column:42}},"5":{start:{line:6,column:11},end:{line:6,column:39}},"6":{start:{line:7,column:16},end:{line:7,column:42}},"7":{start:{line:8,column:19},end:{line:8,column:41}},"8":{start:{line:10,column:15},end:{line:10,column:34}},"9":{start:{line:11,column:16},end:{line:11,column:43}},"10":{start:{line:12,column:13},end:{line:12,column:37}},"11":{start:{line:13,column:16},end:{line:13,column:43}},"12":{start:{line:14,column:15},end:{line:14,column:41}},"13":{start:{line:16,column:0},end:{line:21,column:3}},"14":{start:{line:22,column:0},end:{line:22,column:55}},"15":{start:{line:23,column:0},end:{line:23,column:26}},"16":{start:{line:24,column:0},end:{line:24,column:49}},"17":{start:{line:25,column:0},end:{line:25,column:26}},"18":{start:{line:26,column:0},end:{line:26,column:34}},"19":{start:{line:27,column:0},end:{line:27,column:19}},"20":{start:{line:28,column:0},end:{line:28,column:23}},"21":{start:{line:29,column:0},end:{line:31,column:3}},"22":{start:{line:30,column:4},end:{line:30,column:73}},"23":{start:{line:33,column:16},end:{line:33,column:47}},"24":{start:{line:34,column:20},end:{line:34,column:29}},"25":{start:{line:35,column:0},end:{line:190,column:2}},"26":{start:{line:36,column:25},end:{line:36,column:56}},"27":{start:{line:39,column:4},end:{line:48,column:6}},"28":{start:{line:40,column:8},end:{line:40,column:50}},"29":{start:{line:41,column:24},end:{line:41,column:60}},"30":{start:{line:42,column:8},end:{line:47,column:10}},"31":{start:{line:43,column:12},end:{line:43,column:68}},"32":{start:{line:44,column:12},end:{line:46,column:14}},"33":{start:{line:45,column:16},end:{line:45,column:61}},"34":{start:{line:51,column:4},end:{line:64,column:6}},"35":{start:{line:52,column:21},end:{line:52,column:40}},"36":{start:{line:53,column:19},end:{line:53,column:37}},"37":{start:{line:54,column:25},end:{line:54,column:42}},"38":{start:{line:55,column:23},end:{line:55,column:64}},"39":{start:{line:56,column:8},end:{line:60,column:10}},"40":{start:{line:57,column:24},end:{line:57,column:49}},"41":{start:{line:58,column:12},end:{line:58,column:74}},"42":{start:{line:61,column:8},end:{line:63,column:10}},"43":{start:{line:62,column:12},end:{line:62,column:36}},"44":{start:{line:65,column:4},end:{line:72,column:6}},"45":{start:{line:66,column:21},end:{line:66,column:40}},"46":{start:{line:67,column:19},end:{line:67,column:37}},"47":{start:{line:68,column:23},end:{line:68,column:64}},"48":{start:{line:69,column:8},end:{line:71,column:10}},"49":{start:{line:70,column:12},end:{line:70,column:63}},"50":{start:{line:74,column:4},end:{line:85,column:6}},"51":{start:{line:75,column:24},end:{line:75,column:53}},"52":{start:{line:76,column:8},end:{line:83,column:9}},"53":{start:{line:77,column:23},end:{line:77,column:30}},"54":{start:{line:78,column:12},end:{line:78,column:27}},"55":{start:{line:79,column:26},end:{line:79,column:65}},"56":{start:{line:80,column:12},end:{line:80,column:35}},"57":{start:{line:81,column:12},end:{line:81,column:40}},"58":{start:{line:82,column:12},end:{line:82,column:72}},"59":{start:{line:84,column:8},end:{line:84,column:46}},"60":{start:{line:88,column:4},end:{line:113,column:6}},"61":{start:{line:89,column:19},end:{line:89,column:26}},"62":{start:{line:90,column:8},end:{line:112,column:10}},"63":{start:{line:91,column:12},end:{line:91,column:27}},"64":{start:{line:92,column:27},end:{line:92,column:59}},"65":{start:{line:93,column:28},end:{line:99,column:13}},"66":{start:{line:100,column:33},end:{line:106,column:13}},"67":{start:{line:107,column:12},end:{line:107,column:46}},"68":{start:{line:108,column:32},end:{line:108,column:73}},"69":{start:{line:109,column:12},end:{line:111,column:14}},"70":{start:{line:110,column:16},end:{line:110,column:60}},"71":{start:{line:116,column:4},end:{line:122,column:6}},"72":{start:{line:117,column:19},end:{line:117,column:26}},"73":{start:{line:118,column:8},end:{line:121,column:10}},"74":{start:{line:119,column:12},end:{line:119,column:27}},"75":{start:{line:120,column:27},end:{line:120,column:59}},"76":{start:{line:126,column:4},end:{line:132,column:6}},"77":{start:{line:127,column:24},end:{line:127,column:56}},"78":{start:{line:130,column:8},end:{line:130,column:49}},"79":{start:{line:131,column:8},end:{line:131,column:75}},"80":{start:{line:135,column:4},end:{line:140,column:6}},"81":{start:{line:136,column:22},end:{line:136,column:53}},"82":{start:{line:137,column:8},end:{line:139,column:10}},"83":{start:{line:138,column:12},end:{line:138,column:44}},"84":{start:{line:142,column:4},end:{line:149,column:6}},"85":{start:{line:143,column:23},end:{line:143,column:52}},"86":{start:{line:144,column:8},end:{line:144,column:25}},"87":{start:{line:145,column:8},end:{line:148,column:10}},"88":{start:{line:146,column:12},end:{line:146,column:45}},"89":{start:{line:147,column:12},end:{line:147,column:96}},"90":{start:{line:151,column:4},end:{line:158,column:6}},"91":{start:{line:152,column:23},end:{line:152,column:51}},"92":{start:{line:153,column:8},end:{line:157,column:9}},"93":{start:{line:154,column:12},end:{line:154,column:45}},"94":{start:{line:156,column:12},end:{line:156,column:58}},"95":{start:{line:161,column:4},end:{line:165,column:6}},"96":{start:{line:162,column:22},end:{line:162,column:54}},"97":{start:{line:163,column:23},end:{line:163,column:54}},"98":{start:{line:164,column:8},end:{line:164,column:52}},"99":{start:{line:168,column:4},end:{line:175,column:6}},"100":{start:{line:170,column:8},end:{line:174,column:9}},"101":{start:{line:171,column:23},end:{line:171,column:32}},"102":{start:{line:172,column:29},end:{line:172,column:64}},"103":{start:{line:173,column:12},end:{line:173,column:55}},"104":{start:{line:177,column:4},end:{line:180,column:6}},"105":{start:{line:178,column:20},end:{line:178,column:56}},"106":{start:{line:179,column:8},end:{line:179,column:41}},"107":{start:{line:182,column:4},end:{line:185,column:6}},"108":{start:{line:183,column:24},end:{line:183,column:59}},"109":{start:{line:184,column:8},end:{line:184,column:58}},"110":{start:{line:187,column:4},end:{line:189,column:6}},"111":{start:{line:188,column:8},end:{line:188,column:33}},"112":{start:{line:191,column:0},end:{line:193,column:3}},"113":{start:{line:192,column:4},end:{line:192,column:29}},"114":{start:{line:195,column:0},end:{line:195,column:21}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:29,column:33},end:{line:29,column:34}},loc:{start:{line:29,column:48},end:{line:31,column:1}},line:29},"1":{name:"(anonymous_1)",decl:{start:{line:35,column:20},end:{line:35,column:21}},loc:{start:{line:35,column:36},end:{line:190,column:1}},line:35},"2":{name:"(anonymous_2)",decl:{start:{line:39,column:22},end:{line:39,column:23}},loc:{start:{line:39,column:52},end:{line:48,column:5}},line:39},"3":{name:"(anonymous_3)",decl:{start:{line:42,column:24},end:{line:42,column:25}},loc:{start:{line:42,column:34},end:{line:47,column:9}},line:42},"4":{name:"(anonymous_4)",decl:{start:{line:44,column:85},end:{line:44,column:86}},loc:{start:{line:44,column:91},end:{line:46,column:13}},line:44},"5":{name:"(anonymous_5)",decl:{start:{line:51,column:22},end:{line:51,column:23}},loc:{start:{line:51,column:40},end:{line:64,column:5}},line:51},"6":{name:"(anonymous_6)",decl:{start:{line:56,column:24},end:{line:56,column:25}},loc:{start:{line:56,column:30},end:{line:60,column:9}},line:56},"7":{name:"(anonymous_7)",decl:{start:{line:61,column:25},end:{line:61,column:26}},loc:{start:{line:61,column:36},end:{line:63,column:9}},line:61},"8":{name:"(anonymous_8)",decl:{start:{line:65,column:26},end:{line:65,column:27}},loc:{start:{line:65,column:44},end:{line:72,column:5}},line:65},"9":{name:"(anonymous_9)",decl:{start:{line:69,column:24},end:{line:69,column:25}},loc:{start:{line:69,column:30},end:{line:71,column:9}},line:69},"10":{name:"(anonymous_10)",decl:{start:{line:74,column:27},end:{line:74,column:28}},loc:{start:{line:74,column:41},end:{line:85,column:5}},line:74},"11":{name:"(anonymous_11)",decl:{start:{line:88,column:31},end:{line:88,column:32}},loc:{start:{line:88,column:39},end:{line:113,column:5}},line:88},"12":{name:"(anonymous_12)",decl:{start:{line:90,column:24},end:{line:90,column:25}},loc:{start:{line:90,column:36},end:{line:112,column:9}},line:90},"13":{name:"(anonymous_13)",decl:{start:{line:109,column:48},end:{line:109,column:49}},loc:{start:{line:109,column:54},end:{line:111,column:13}},line:109},"14":{name:"(anonymous_14)",decl:{start:{line:116,column:32},end:{line:116,column:33}},loc:{start:{line:116,column:40},end:{line:122,column:5}},line:116},"15":{name:"(anonymous_15)",decl:{start:{line:118,column:24},end:{line:118,column:25}},loc:{start:{line:118,column:36},end:{line:121,column:9}},line:118},"16":{name:"(anonymous_16)",decl:{start:{line:126,column:25},end:{line:126,column:26}},loc:{start:{line:126,column:39},end:{line:132,column:5}},line:126},"17":{name:"(anonymous_17)",decl:{start:{line:135,column:29},end:{line:135,column:30}},loc:{start:{line:135,column:43},end:{line:140,column:5}},line:135},"18":{name:"(anonymous_18)",decl:{start:{line:137,column:31},end:{line:137,column:32}},loc:{start:{line:137,column:37},end:{line:139,column:9}},line:137},"19":{name:"(anonymous_19)",decl:{start:{line:142,column:27},end:{line:142,column:28}},loc:{start:{line:142,column:41},end:{line:149,column:5}},line:142},"20":{name:"(anonymous_20)",decl:{start:{line:145,column:34},end:{line:145,column:35}},loc:{start:{line:145,column:40},end:{line:148,column:9}},line:145},"21":{name:"(anonymous_21)",decl:{start:{line:151,column:26},end:{line:151,column:27}},loc:{start:{line:151,column:40},end:{line:158,column:5}},line:151},"22":{name:"(anonymous_22)",decl:{start:{line:161,column:32},end:{line:161,column:33}},loc:{start:{line:161,column:46},end:{line:165,column:5}},line:161},"23":{name:"(anonymous_23)",decl:{start:{line:168,column:36},end:{line:168,column:37}},loc:{start:{line:168,column:53},end:{line:175,column:5}},line:168},"24":{name:"(anonymous_24)",decl:{start:{line:177,column:34},end:{line:177,column:35}},loc:{start:{line:177,column:51},end:{line:180,column:5}},line:177},"25":{name:"(anonymous_25)",decl:{start:{line:182,column:33},end:{line:182,column:34}},loc:{start:{line:182,column:47},end:{line:185,column:5}},line:182},"26":{name:"(anonymous_26)",decl:{start:{line:187,column:28},end:{line:187,column:29}},loc:{start:{line:187,column:34},end:{line:189,column:5}},line:187},"27":{name:"(anonymous_27)",decl:{start:{line:191,column:20},end:{line:191,column:21}},loc:{start:{line:191,column:26},end:{line:193,column:1}},line:191}},branchMap:{"0":{loc:{start:{line:44,column:12},end:{line:46,column:14}},type:"binary-expr",locations:[{start:{line:44,column:12},end:{line:44,column:58}},{start:{line:44,column:62},end:{line:46,column:14}}],line:44},"1":{loc:{start:{line:76,column:8},end:{line:83,column:9}},type:"if",locations:[{start:{line:76,column:8},end:{line:83,column:9}},{start:{line:76,column:8},end:{line:83,column:9}}],line:76},"2":{loc:{start:{line:80,column:12},end:{line:80,column:35}},type:"binary-expr",locations:[{start:{line:80,column:12},end:{line:80,column:17}},{start:{line:80,column:21},end:{line:80,column:35}}],line:80},"3":{loc:{start:{line:109,column:12},end:{line:111,column:14}},type:"binary-expr",locations:[{start:{line:109,column:12},end:{line:109,column:23}},{start:{line:109,column:27},end:{line:111,column:14}}],line:109},"4":{loc:{start:{line:153,column:8},end:{line:157,column:9}},type:"if",locations:[{start:{line:153,column:8},end:{line:157,column:9}},{start:{line:153,column:8},end:{line:157,column:9}}],line:153},"5":{loc:{start:{line:170,column:8},end:{line:174,column:9}},type:"if",locations:[{start:{line:170,column:8},end:{line:174,column:9}},{start:{line:170,column:8},end:{line:174,column:9}}],line:170},"6":{loc:{start:{line:184,column:8},end:{line:184,column:58}},type:"binary-expr",locations:[{start:{line:184,column:8},end:{line:184,column:15}},{start:{line:184,column:19},end:{line:184,column:58}}],line:184}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"e12a808a3356b677e1ff0941f4ed1a86921db7fc"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_lxz1l9gm7=function(){return actualCoverage;};return actualCoverage;}cov_lxz1l9gm7();cov_lxz1l9gm7().s[0]++;require('./main');const path=(cov_lxz1l9gm7().s[1]++,require("path"));const express=(cov_lxz1l9gm7().s[2]++,require('express'));const app=(cov_lxz1l9gm7().s[3]++,express());const server=(cov_lxz1l9gm7().s[4]++,require('http').Server(app));const io=(cov_lxz1l9gm7().s[5]++,require('socket.io')(server));const session=(cov_lxz1l9gm7().s[6]++,require("express-session"));const bodyParser=(cov_lxz1l9gm7().s[7]++,require('body-parser'));const config=(cov_lxz1l9gm7().s[8]++,require("./config"));const captcha=(cov_lxz1l9gm7().s[9]++,require("./router/captcha"));const user=(cov_lxz1l9gm7().s[10]++,require("./router/user"));const message=(cov_lxz1l9gm7().s[11]++,require("./router/message"));const upload=(cov_lxz1l9gm7().s[12]++,require("./router/upload"));cov_lxz1l9gm7().s[13]++;app.use(session({secret:'keyboard cat',//使用随机自定义字符串进行加密
resave:false,//即使 session 没有被修改，也保存 session 值，默认为 true
saveUninitialized:true,//不保存未初始化的cookie，也就是未登录的cookie
cookie:{secure:false}}));cov_lxz1l9gm7().s[14]++;app.use(express.static(path.join(__dirname,'public')));cov_lxz1l9gm7().s[15]++;app.use(bodyParser.json());//中间件只会解析 json ，允许请求提任意Unicode编码支持 gzip 和 deflate 编码
cov_lxz1l9gm7().s[16]++;app.use(bodyParser.urlencoded({extended:false}));cov_lxz1l9gm7().s[17]++;app.use('/upload',upload);cov_lxz1l9gm7().s[18]++;app.use('/getImageCode',captcha);cov_lxz1l9gm7().s[19]++;app.use('/',user);cov_lxz1l9gm7().s[20]++;app.use('/m',message);cov_lxz1l9gm7().s[21]++;process.on('unhandledRejection',(reason,p)=>{cov_lxz1l9gm7().f[0]++;cov_lxz1l9gm7().s[22]++;console.log('Unhandled Rejection at: Promise',p,'reason:',reason);});const apiList=(cov_lxz1l9gm7().s[23]++,require('./controller/apiList'));const onlineUsers=(cov_lxz1l9gm7().s[24]++,new Map());cov_lxz1l9gm7().s[25]++;io.on("connection",async socket=>{cov_lxz1l9gm7().f[1]++;const defaultGroup=(cov_lxz1l9gm7().s[26]++,await apiList.getDefaultGroup());//将连接到后端的用户socket和userId保存起来,并且发送好友通知
cov_lxz1l9gm7().s[27]++;socket.on('init',async({socketId,userId})=>{cov_lxz1l9gm7().f[2]++;cov_lxz1l9gm7().s[28]++;onlineUsers.set(userId.toString(),socket);const friends=(cov_lxz1l9gm7().s[29]++,await apiList.findFriendByTo(userId));cov_lxz1l9gm7().s[30]++;friends.forEach(friend=>{cov_lxz1l9gm7().f[3]++;cov_lxz1l9gm7().s[31]++;console.log(friend.to._id.toString(),userId.toString());cov_lxz1l9gm7().s[32]++;(cov_lxz1l9gm7().b[0][0]++,friend.to._id.toString()===userId.toString())&&(cov_lxz1l9gm7().b[0][1]++,socket.join(friend.id,()=>{cov_lxz1l9gm7().f[4]++;cov_lxz1l9gm7().s[33]++;socket.emit('setFriendSystemMessage',friend);}));});});// 用户点击列表进入聊天界面
cov_lxz1l9gm7().s[34]++;socket.on('join',async userInfo=>{cov_lxz1l9gm7().f[5]++;const type=(cov_lxz1l9gm7().s[35]++,userInfo.focus.type);// 1表示群组， 0表示好友
const id=(cov_lxz1l9gm7().s[36]++,userInfo.focus._id);//id
const linkmans=(cov_lxz1l9gm7().s[37]++,userInfo.linkmans);let messages=(cov_lxz1l9gm7().s[38]++,await apiList.getCurLastMessage(id,type));cov_lxz1l9gm7().s[39]++;socket.join(id,()=>{cov_lxz1l9gm7().f[6]++;let rooms=(cov_lxz1l9gm7().s[40]++,Object.keys(socket.rooms));cov_lxz1l9gm7().s[41]++;io.sockets.in(id).emit('joined',{id:id,messages:messages});//包括自己
// socket.broadcast.to(defaultGroup._id).emit('joined', 'hh')//不包括自己
});cov_lxz1l9gm7().s[42]++;linkmans.forEach(linkman=>{cov_lxz1l9gm7().f[7]++;cov_lxz1l9gm7().s[43]++;socket.join(linkman._id);});});cov_lxz1l9gm7().s[44]++;socket.on('setFocus',async userInfo=>{cov_lxz1l9gm7().f[8]++;const type=(cov_lxz1l9gm7().s[45]++,userInfo.focus.type);// 1表示群组， 0表示好友
const id=(cov_lxz1l9gm7().s[46]++,userInfo.focus._id);//id
let messages=(cov_lxz1l9gm7().s[47]++,await apiList.getCurLastMessage(id,type));cov_lxz1l9gm7().s[48]++;socket.join(id,()=>{cov_lxz1l9gm7().f[9]++;cov_lxz1l9gm7().s[49]++;socket.emit('joined',{id:id,messages:messages});});});//添加好友申请
cov_lxz1l9gm7().s[50]++;socket.on('addFriend',async data=>{cov_lxz1l9gm7().f[10]++;const friendR=(cov_lxz1l9gm7().s[51]++,await apiList.addFriend(data));cov_lxz1l9gm7().s[52]++;if(friendR.status!==400){cov_lxz1l9gm7().b[1][0]++;const id=(cov_lxz1l9gm7().s[53]++,data.id);cov_lxz1l9gm7().s[54]++;socket.join(id);const other=(cov_lxz1l9gm7().s[55]++,onlineUsers.get(data.to._id.toString()));cov_lxz1l9gm7().s[56]++;(cov_lxz1l9gm7().b[2][0]++,other)&&(cov_lxz1l9gm7().b[2][1]++,other.join(id));cov_lxz1l9gm7().s[57]++;data.status=friendR.status;cov_lxz1l9gm7().s[58]++;socket.broadcast.to(id).emit('setFriendSystemMessage',data);}else{cov_lxz1l9gm7().b[1][1]++;}cov_lxz1l9gm7().s[59]++;socket.emit('addFriendAfter',friendR);});//对方同意加为好友
cov_lxz1l9gm7().s[60]++;socket.on('agreeValidate',data=>{cov_lxz1l9gm7().f[11]++;const id=(cov_lxz1l9gm7().s[61]++,data.id);cov_lxz1l9gm7().s[62]++;socket.join(id,async()=>{cov_lxz1l9gm7().f[12]++;cov_lxz1l9gm7().s[63]++;data.status=1;const friend=(cov_lxz1l9gm7().s[64]++,await apiList.updateFriend(data));const linkman=(cov_lxz1l9gm7().s[65]++,{_id:id,name:data.from.username,avatar:data.from.avatar,createTime:friend.createTime,type:0});const otherLinkman=(cov_lxz1l9gm7().s[66]++,{_id:id,name:data.to.username,avatar:data.to.avatar,createTime:friend.createTime,type:0});cov_lxz1l9gm7().s[67]++;socket.emit('addLinkman',linkman);const otherSocket=(cov_lxz1l9gm7().s[68]++,onlineUsers.get(data.from._id.toString()));cov_lxz1l9gm7().s[69]++;(cov_lxz1l9gm7().b[3][0]++,otherSocket)&&(cov_lxz1l9gm7().b[3][1]++,otherSocket.join(id,()=>{cov_lxz1l9gm7().f[13]++;cov_lxz1l9gm7().s[70]++;otherSocket.emit('addLinkman',otherLinkman);}));});});//对方拒绝加为好友
cov_lxz1l9gm7().s[71]++;socket.on('refuseValidate',data=>{cov_lxz1l9gm7().f[14]++;const id=(cov_lxz1l9gm7().s[72]++,data.id);cov_lxz1l9gm7().s[73]++;socket.join(id,async()=>{cov_lxz1l9gm7().f[15]++;cov_lxz1l9gm7().s[74]++;data.status=2;const friend=(cov_lxz1l9gm7().s[75]++,await apiList.updateFriend(data));});});// 发送消息
cov_lxz1l9gm7().s[76]++;socket.on('message',async data=>{cov_lxz1l9gm7().f[16]++;const message=(cov_lxz1l9gm7().s[77]++,await apiList.saveMessages(data));// io.emit('message', data);
// socket.broadcast.emit('message',data);
cov_lxz1l9gm7().s[78]++;socket.emit('setFocusMessage',{message});cov_lxz1l9gm7().s[79]++;socket.broadcast.to(message.to).emit('setFocusMessage',{message});});//创建群组
cov_lxz1l9gm7().s[80]++;socket.on('createGroup',async data=>{cov_lxz1l9gm7().f[17]++;const group=(cov_lxz1l9gm7().s[81]++,await apiList.createGroup(data));cov_lxz1l9gm7().s[82]++;socket.join(group._id,()=>{cov_lxz1l9gm7().f[18]++;cov_lxz1l9gm7().s[83]++;socket.emit('addLinkman',group);});});//加入群组
cov_lxz1l9gm7().s[84]++;socket.on('joinGroup',async data=>{cov_lxz1l9gm7().f[19]++;const result=(cov_lxz1l9gm7().s[85]++,await apiList.joinGroup(data));cov_lxz1l9gm7().s[86]++;console.log(data);cov_lxz1l9gm7().s[87]++;socket.join(data.groupId,()=>{cov_lxz1l9gm7().f[20]++;cov_lxz1l9gm7().s[88]++;socket.emit('addLinkman',result);cov_lxz1l9gm7().s[89]++;socket.broadcast.to(data.groupId).emit('setFocusMessage',{message:result.message});});});//解散群组
cov_lxz1l9gm7().s[90]++;socket.on('delGroup',async data=>{cov_lxz1l9gm7().f[21]++;const result=(cov_lxz1l9gm7().s[91]++,await apiList.delGroup(data));cov_lxz1l9gm7().s[92]++;if(result.status){cov_lxz1l9gm7().b[4][0]++;cov_lxz1l9gm7().s[93]++;socket.emit('delLinkman',result);}else{cov_lxz1l9gm7().b[4][1]++;cov_lxz1l9gm7().s[94]++;io.sockets.in(data).emit('delLinkman',result);}});//查找群组和用户
cov_lxz1l9gm7().s[95]++;socket.on('searchLinkmans',async data=>{cov_lxz1l9gm7().f[22]++;const users=(cov_lxz1l9gm7().s[96]++,await apiList.searchFriend(data));const groups=(cov_lxz1l9gm7().s[97]++,await apiList.searchGroup(data));cov_lxz1l9gm7().s[98]++;socket.emit('searchResult',{users,groups});});cov_lxz1l9gm7().s[99]++;socket.on('getHistoryMessages',async focus=>{cov_lxz1l9gm7().f[23]++;cov_lxz1l9gm7().s[100]++;// console.log(focus)
if(focus){cov_lxz1l9gm7().b[5][0]++;const id=(cov_lxz1l9gm7().s[101]++,focus._id);const messages=(cov_lxz1l9gm7().s[102]++,await apiList.getHistoryMessage(id));cov_lxz1l9gm7().s[103]++;socket.emit('getHistoryMessages',messages);}else{cov_lxz1l9gm7().b[5][1]++;}});cov_lxz1l9gm7().s[104]++;socket.on('searchExpression',async keyword=>{cov_lxz1l9gm7().f[24]++;const res=(cov_lxz1l9gm7().s[105]++,await apiList.getExpression(keyword));cov_lxz1l9gm7().s[106]++;socket.emit('getExpression',res);});cov_lxz1l9gm7().s[107]++;socket.on('getGroupMembers',async name=>{cov_lxz1l9gm7().f[25]++;const members=(cov_lxz1l9gm7().s[108]++,await apiList.getGroupMembers(name));cov_lxz1l9gm7().s[109]++;(cov_lxz1l9gm7().b[6][0]++,members)&&(cov_lxz1l9gm7().b[6][1]++,socket.emit('setGroupMembers',members));});cov_lxz1l9gm7().s[110]++;socket.on('disconnect',()=>{cov_lxz1l9gm7().f[26]++;cov_lxz1l9gm7().s[111]++;console.log('disconnect');});});cov_lxz1l9gm7().s[112]++;server.listen(3000,()=>{cov_lxz1l9gm7().f[27]++;cov_lxz1l9gm7().s[113]++;console.log('服务器在3000启动');});cov_lxz1l9gm7().s[114]++;module.exports=app;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlIiwicGF0aCIsImV4cHJlc3MiLCJhcHAiLCJzZXJ2ZXIiLCJTZXJ2ZXIiLCJpbyIsInNlc3Npb24iLCJib2R5UGFyc2VyIiwiY29uZmlnIiwiY2FwdGNoYSIsInVzZXIiLCJtZXNzYWdlIiwidXBsb2FkIiwidXNlIiwic2VjcmV0IiwicmVzYXZlIiwic2F2ZVVuaW5pdGlhbGl6ZWQiLCJjb29raWUiLCJzZWN1cmUiLCJzdGF0aWMiLCJqb2luIiwiX19kaXJuYW1lIiwianNvbiIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsInByb2Nlc3MiLCJvbiIsInJlYXNvbiIsInAiLCJjb25zb2xlIiwibG9nIiwiYXBpTGlzdCIsIm9ubGluZVVzZXJzIiwiTWFwIiwic29ja2V0IiwiZGVmYXVsdEdyb3VwIiwiZ2V0RGVmYXVsdEdyb3VwIiwic29ja2V0SWQiLCJ1c2VySWQiLCJzZXQiLCJ0b1N0cmluZyIsImZyaWVuZHMiLCJmaW5kRnJpZW5kQnlUbyIsImZvckVhY2giLCJmcmllbmQiLCJ0byIsIl9pZCIsImlkIiwiZW1pdCIsInVzZXJJbmZvIiwidHlwZSIsImZvY3VzIiwibGlua21hbnMiLCJtZXNzYWdlcyIsImdldEN1ckxhc3RNZXNzYWdlIiwicm9vbXMiLCJPYmplY3QiLCJrZXlzIiwic29ja2V0cyIsImluIiwibGlua21hbiIsImRhdGEiLCJmcmllbmRSIiwiYWRkRnJpZW5kIiwic3RhdHVzIiwib3RoZXIiLCJnZXQiLCJicm9hZGNhc3QiLCJ1cGRhdGVGcmllbmQiLCJuYW1lIiwiZnJvbSIsInVzZXJuYW1lIiwiYXZhdGFyIiwiY3JlYXRlVGltZSIsIm90aGVyTGlua21hbiIsIm90aGVyU29ja2V0Iiwic2F2ZU1lc3NhZ2VzIiwiZ3JvdXAiLCJjcmVhdGVHcm91cCIsInJlc3VsdCIsImpvaW5Hcm91cCIsImdyb3VwSWQiLCJkZWxHcm91cCIsInVzZXJzIiwic2VhcmNoRnJpZW5kIiwiZ3JvdXBzIiwic2VhcmNoR3JvdXAiLCJnZXRIaXN0b3J5TWVzc2FnZSIsImtleXdvcmQiLCJyZXMiLCJnZXRFeHByZXNzaW9uIiwibWVtYmVycyIsImdldEdyb3VwTWVtYmVycyIsImxpc3RlbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJrcGJBQUFBLE9BQU8sQ0FBQyxRQUFELENBQVAsQ0FDQSxLQUFNQyxDQUFBQSxJQUFJLHlCQUFHRCxPQUFPLENBQUMsTUFBRCxDQUFWLENBQVYsQ0FDQSxLQUFNRSxDQUFBQSxPQUFPLHlCQUFHRixPQUFPLENBQUMsU0FBRCxDQUFWLENBQWIsQ0FDQSxLQUFNRyxDQUFBQSxHQUFHLHlCQUFHRCxPQUFPLEVBQVYsQ0FBVCxDQUNBLEtBQU1FLENBQUFBLE1BQU0seUJBQUdKLE9BQU8sQ0FBQyxNQUFELENBQVAsQ0FBZ0JLLE1BQWhCLENBQXVCRixHQUF2QixDQUFILENBQVosQ0FDQSxLQUFNRyxDQUFBQSxFQUFFLHlCQUFHTixPQUFPLENBQUMsV0FBRCxDQUFQLENBQXFCSSxNQUFyQixDQUFILENBQVIsQ0FDQSxLQUFNRyxDQUFBQSxPQUFPLHlCQUFHUCxPQUFPLENBQUMsaUJBQUQsQ0FBVixDQUFiLENBQ0EsS0FBTVEsQ0FBQUEsVUFBVSx5QkFBR1IsT0FBTyxDQUFDLGFBQUQsQ0FBVixDQUFoQixDQUVBLEtBQU1TLENBQUFBLE1BQU0seUJBQUdULE9BQU8sQ0FBQyxVQUFELENBQVYsQ0FBWixDQUNBLEtBQU1VLENBQUFBLE9BQU8seUJBQUdWLE9BQU8sQ0FBQyxrQkFBRCxDQUFWLENBQWIsQ0FDQSxLQUFNVyxDQUFBQSxJQUFJLDBCQUFHWCxPQUFPLENBQUMsZUFBRCxDQUFWLENBQVYsQ0FDQSxLQUFNWSxDQUFBQSxPQUFPLDBCQUFHWixPQUFPLENBQUMsa0JBQUQsQ0FBVixDQUFiLENBQ0EsS0FBTWEsQ0FBQUEsTUFBTSwwQkFBR2IsT0FBTyxDQUFDLGlCQUFELENBQVYsQ0FBWixDLHdCQUVBRyxHQUFHLENBQUNXLEdBQUosQ0FBUVAsT0FBTyxDQUFDLENBQ1pRLE1BQU0s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QXRCLENBQVQsQ0FBVCxDQUQyQyx5QkFFM0N0RCxNQUFNLENBQUNjLElBQVAsQ0FBWSxlQUFaLENBQTZCeUMsR0FBN0IsRUFDSCxDQUhELEVBOUlnQyx5QkFtSmhDdkQsTUFBTSxDQUFDUixFQUFQLENBQVUsaUJBQVYsQ0FBNkIsS0FBTTJDLENBQUFBLElBQU4sRUFBYyx5QkFDdkMsS0FBTXNCLENBQUFBLE9BQU8sMkJBQUcsS0FBTTVELENBQUFBLE9BQU8sQ0FBQzZELGVBQVIsQ0FBd0J2QixJQUF4QixDQUFULENBQWIsQ0FEdUMseUJBRXZDLDJCQUFBc0IsT0FBTyw4QkFBSXpELE1BQU0sQ0FBQ2MsSUFBUCxDQUFZLGlCQUFaLENBQStCMkMsT0FBL0IsQ0FBSixDQUFQLENBQ0gsQ0FIRCxFQW5KZ0MseUJBd0poQ3pELE1BQU0sQ0FBQ1IsRUFBUCxDQUFVLFlBQVYsQ0FBd0IsSUFBTSxrREFDMUJHLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLFlBQVosRUFDSCxDQUZELEVBR0gsQ0EzSkQsRSx5QkE0SkEzQixNQUFNLENBQUMwRixNQUFQLENBQWMsSUFBZCxDQUFvQixJQUFNLGtEQUN0QmhFLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLFlBQVosRUFDSCxDQUZELEUseUJBSUFnRSxNQUFNLENBQUNDLE9BQVAsQ0FBaUI3RixHQUFqQiIsInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJy4vbWFpbicpXG5jb25zdCBwYXRoID0gcmVxdWlyZShcInBhdGhcIik7XG5jb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XG5jb25zdCBzZXJ2ZXIgPSByZXF1aXJlKCdodHRwJykuU2VydmVyKGFwcCk7XG5jb25zdCBpbyA9IHJlcXVpcmUoJ3NvY2tldC5pbycpKHNlcnZlcik7XG5jb25zdCBzZXNzaW9uID0gcmVxdWlyZShcImV4cHJlc3Mtc2Vzc2lvblwiKTtcbmNvbnN0IGJvZHlQYXJzZXIgPSByZXF1aXJlKCdib2R5LXBhcnNlcicpXG5cbmNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoXCIuL2NvbmZpZ1wiKTtcbmNvbnN0IGNhcHRjaGEgPSByZXF1aXJlKFwiLi9yb3V0ZXIvY2FwdGNoYVwiKTtcbmNvbnN0IHVzZXIgPSByZXF1aXJlKFwiLi9yb3V0ZXIvdXNlclwiKTtcbmNvbnN0IG1lc3NhZ2UgPSByZXF1aXJlKFwiLi9yb3V0ZXIvbWVzc2FnZVwiKTtcbmNvbnN0IHVwbG9hZCA9IHJlcXVpcmUoXCIuL3JvdXRlci91cGxvYWRcIik7XG5cbmFwcC51c2Uoc2Vzc2lvbih7XG4gICAgc2VjcmV0OiAna2V5Ym9hcmQgY2F0JywvL+S9v+eUqOmaj+acuuiHquWumuS5ieWtl+espuS4sui/m+ihjOWKoOWvhlxuICAgIHJlc2F2ZTogZmFsc2UsLy/ljbPkvb8gc2Vzc2lvbiDmsqHmnInooqvkv67mlLnvvIzkuZ/kv53lrZggc2Vzc2lvbiDlgLzvvIzpu5jorqTkuLogdHJ1ZVxuICAgIHNhdmVVbmluaXRpYWxpemVkOiB0cnVlLC8v5LiN5L+d5a2Y5pyq5Yid5aeL5YyW55qEY29va2ll77yM5Lmf5bCx5piv5pyq55m75b2V55qEY29va2llXG4gICAgY29va2llOiB7IHNlY3VyZTogZmFsc2UgfVxufSkpXG5hcHAudXNlKGV4cHJlc3Muc3RhdGljKHBhdGguam9pbihfX2Rpcm5hbWUsICdwdWJsaWMnKSkpXG5hcHAudXNlKGJvZHlQYXJzZXIuanNvbigpKS8v5Lit6Ze05Lu25Y+q5Lya6Kej5p6QIGpzb24g77yM5YWB6K646K+35rGC5o+Q5Lu75oSPVW5pY29kZee8lueggeaUr+aMgSBnemlwIOWSjCBkZWZsYXRlIOe8lueggVxuYXBwLnVzZShib2R5UGFyc2VyLnVybGVuY29kZWQoe2V4dGVuZGVkOiBmYWxzZX0pKVxuYXBwLnVzZSgnL3VwbG9hZCcsIHVwbG9hZClcbmFwcC51c2UoJy9nZXRJbWFnZUNvZGUnLCBjYXB0Y2hhKTtcbmFwcC51c2UoJy8nLCB1c2VyKTtcbmFwcC51c2UoJy9tJywgbWVzc2FnZSk7XG5wcm9jZXNzLm9uKCd1bmhhbmRsZWRSZWplY3Rpb24nLCAocmVhc29uLCBwKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ1VuaGFuZGxlZCBSZWplY3Rpb24gYXQ6IFByb21pc2UnLCBwLCAncmVhc29uOicsIHJlYXNvbik7XG59KTtcblxuY29uc3QgYXBpTGlzdCA9IHJlcXVpcmUoJy4vY29udHJvbGxlci9hcGlMaXN0JylcbmNvbnN0IG9ubGluZVVzZXJzID0gbmV3IE1hcCgpXG5pby5vbihcImNvbm5lY3Rpb25cIiwgYXN5bmMgc29ja2V0ID0+IHtcbiAgICBjb25zdCBkZWZhdWx0R3JvdXAgPSBhd2FpdCBhcGlMaXN0LmdldERlZmF1bHRHcm91cCgpXG5cbiAgICAvL+Wwhui/nuaOpeWIsOWQjuerr+eahOeUqOaIt3NvY2tldOWSjHVzZXJJZOS/neWtmOi1t+adpSzlubbkuJTlj5HpgIHlpb3lj4vpgJrnn6VcbiAgICBzb2NrZXQub24oJ2luaXQnLCBhc3luYyAoe3NvY2tldElkLCB1c2VySWR9KSA9PiB7XG4gICAgICAgIG9ubGluZVVzZXJzLnNldCh1c2VySWQudG9TdHJpbmcoKSwgc29ja2V0KVxuICAgICAgICBjb25zdCBmcmllbmRzID0gYXdhaXQgYXBpTGlzdC5maW5kRnJpZW5kQnlUbyh1c2VySWQpXG4gICAgICAgIGZyaWVuZHMuZm9yRWFjaChmcmllbmQgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZnJpZW5kLnRvLl9pZC50b1N0cmluZygpLCB1c2VySWQudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIGZyaWVuZC50by5faWQudG9TdHJpbmcoKSA9PT0gdXNlcklkLnRvU3RyaW5nKCkgJiYgc29ja2V0LmpvaW4oZnJpZW5kLmlkLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgc29ja2V0LmVtaXQoJ3NldEZyaWVuZFN5c3RlbU1lc3NhZ2UnLCBmcmllbmQpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH0pXG5cbiAgICAvLyDnlKjmiLfngrnlh7vliJfooajov5vlhaXogYrlpKnnlYzpnaJcbiAgICBzb2NrZXQub24oJ2pvaW4nLCBhc3luYyB1c2VySW5mbyA9PiB7XG4gICAgICAgIGNvbnN0IHR5cGUgPSB1c2VySW5mby5mb2N1cy50eXBlIC8vIDHooajnpLrnvqTnu4TvvIwgMOihqOekuuWlveWPi1xuICAgICAgICBjb25zdCBpZCA9IHVzZXJJbmZvLmZvY3VzLl9pZCAgIC8vaWRcbiAgICAgICAgY29uc3QgbGlua21hbnMgPSB1c2VySW5mby5saW5rbWFuc1xuICAgICAgICBsZXQgbWVzc2FnZXMgPSBhd2FpdCBhcGlMaXN0LmdldEN1ckxhc3RNZXNzYWdlKGlkLCB0eXBlKVxuICAgICAgICBzb2NrZXQuam9pbihpZCwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHJvb21zID0gT2JqZWN0LmtleXMoc29ja2V0LnJvb21zKVxuICAgICAgICAgICAgaW8uc29ja2V0cy5pbihpZCkuZW1pdCgnam9pbmVkJywge2lkOiBpZCwgbWVzc2FnZXM6IG1lc3NhZ2VzfSkvL+WMheaLrOiHquW3sVxuICAgICAgICAgICAgLy8gc29ja2V0LmJyb2FkY2FzdC50byhkZWZhdWx0R3JvdXAuX2lkKS5lbWl0KCdqb2luZWQnLCAnaGgnKS8v5LiN5YyF5ous6Ieq5bexXG4gICAgICAgIH0pXG4gICAgICAgIGxpbmttYW5zLmZvckVhY2gobGlua21hbiA9PiB7XG4gICAgICAgICAgICBzb2NrZXQuam9pbihsaW5rbWFuLl9pZClcbiAgICAgICAgfSlcbiAgICB9KVxuICAgIHNvY2tldC5vbignc2V0Rm9jdXMnLCBhc3luYyB1c2VySW5mbyA9PiB7XG4gICAgICAgIGNvbnN0IHR5cGUgPSB1c2VySW5mby5mb2N1cy50eXBlIC8vIDHooajnpLrnvqTnu4TvvIwgMOihqOekuuWlveWPi1xuICAgICAgICBjb25zdCBpZCA9IHVzZXJJbmZvLmZvY3VzLl9pZCAgIC8vaWRcbiAgICAgICAgbGV0IG1lc3NhZ2VzID0gYXdhaXQgYXBpTGlzdC5nZXRDdXJMYXN0TWVzc2FnZShpZCwgdHlwZSlcbiAgICAgICAgc29ja2V0LmpvaW4oaWQsICgpID0+IHtcbiAgICAgICAgICAgIHNvY2tldC5lbWl0KCdqb2luZWQnLCB7aWQ6IGlkLCBtZXNzYWdlczogbWVzc2FnZXN9KVxuICAgICAgICB9KVxuICAgIH0pXG4gICAgLy/mt7vliqDlpb3lj4vnlLPor7dcbiAgICBzb2NrZXQub24oJ2FkZEZyaWVuZCcsIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgICBjb25zdCBmcmllbmRSID0gYXdhaXQgYXBpTGlzdC5hZGRGcmllbmQoZGF0YSlcbiAgICAgICAgaWYgKGZyaWVuZFIuc3RhdHVzICE9PSA0MDApIHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gZGF0YS5pZFxuICAgICAgICAgICAgc29ja2V0LmpvaW4oaWQpXG4gICAgICAgICAgICBjb25zdCBvdGhlciA9IG9ubGluZVVzZXJzLmdldChkYXRhLnRvLl9pZC50b1N0cmluZygpKVxuICAgICAgICAgICAgb3RoZXIgJiYgb3RoZXIuam9pbihpZClcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gZnJpZW5kUi5zdGF0dXNcbiAgICAgICAgICAgIHNvY2tldC5icm9hZGNhc3QudG8oaWQpLmVtaXQoJ3NldEZyaWVuZFN5c3RlbU1lc3NhZ2UnLCBkYXRhKVxuICAgICAgICB9XG4gICAgICAgIHNvY2tldC5lbWl0KCdhZGRGcmllbmRBZnRlcicsIGZyaWVuZFIpXG4gICAgfSlcblxuICAgIC8v5a+55pa55ZCM5oSP5Yqg5Li65aW95Y+LXG4gICAgc29ja2V0Lm9uKCdhZ3JlZVZhbGlkYXRlJywgZGF0YSA9PiB7XG4gICAgICAgIGNvbnN0IGlkID0gZGF0YS5pZFxuICAgICAgICBzb2NrZXQuam9pbihpZCwgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAxXG4gICAgICAgICAgICBjb25zdCBmcmllbmQgPSBhd2FpdCBhcGlMaXN0LnVwZGF0ZUZyaWVuZChkYXRhKVxuICAgICAgICAgICAgY29uc3QgbGlua21hbiA9IHtcbiAgICAgICAgICAgICAgICBfaWQ6IGlkLFxuICAgICAgICAgICAgICAgIG5hbWU6IGRhdGEuZnJvbS51c2VybmFtZSxcbiAgICAgICAgICAgICAgICBhdmF0YXI6IGRhdGEuZnJvbS5hdmF0YXIsXG4gICAgICAgICAgICAgICAgY3JlYXRlVGltZTogZnJpZW5kLmNyZWF0ZVRpbWUsXG4gICAgICAgICAgICAgICAgdHlwZTogMFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgb3RoZXJMaW5rbWFuID0ge1xuICAgICAgICAgICAgICAgIF9pZDogaWQsXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS50by51c2VybmFtZSxcbiAgICAgICAgICAgICAgICBhdmF0YXI6IGRhdGEudG8uYXZhdGFyLFxuICAgICAgICAgICAgICAgIGNyZWF0ZVRpbWU6IGZyaWVuZC5jcmVhdGVUaW1lLFxuICAgICAgICAgICAgICAgIHR5cGU6IDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNvY2tldC5lbWl0KCdhZGRMaW5rbWFuJywgbGlua21hbilcbiAgICAgICAgICAgIGNvbnN0IG90aGVyU29ja2V0ID0gb25saW5lVXNlcnMuZ2V0KGRhdGEuZnJvbS5faWQudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIG90aGVyU29ja2V0ICYmIG90aGVyU29ja2V0LmpvaW4oaWQsICgpID0+IHtcbiAgICAgICAgICAgICAgICBvdGhlclNvY2tldC5lbWl0KCdhZGRMaW5rbWFuJywgb3RoZXJMaW5rbWFuKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9KVxuXG4gICAgLy/lr7nmlrnmi5Lnu53liqDkuLrlpb3lj4tcbiAgICBzb2NrZXQub24oJ3JlZnVzZVZhbGlkYXRlJywgZGF0YSA9PiB7XG4gICAgICAgIGNvbnN0IGlkID0gZGF0YS5pZFxuICAgICAgICBzb2NrZXQuam9pbihpZCwgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAyXG4gICAgICAgICAgICBjb25zdCBmcmllbmQgPSBhd2FpdCBhcGlMaXN0LnVwZGF0ZUZyaWVuZChkYXRhKVxuICAgICAgICB9KVxuICAgIH0pXG5cblxuICAgIC8vIOWPkemAgea2iOaBr1xuICAgIHNvY2tldC5vbignbWVzc2FnZScsIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gYXdhaXQgYXBpTGlzdC5zYXZlTWVzc2FnZXMoZGF0YSlcbiAgICAgICAgLy8gaW8uZW1pdCgnbWVzc2FnZScsIGRhdGEpO1xuICAgICAgICAvLyBzb2NrZXQuYnJvYWRjYXN0LmVtaXQoJ21lc3NhZ2UnLGRhdGEpO1xuICAgICAgICBzb2NrZXQuZW1pdCgnc2V0Rm9jdXNNZXNzYWdlJywge21lc3NhZ2V9KVxuICAgICAgICBzb2NrZXQuYnJvYWRjYXN0LnRvKG1lc3NhZ2UudG8pLmVtaXQoJ3NldEZvY3VzTWVzc2FnZScsIHttZXNzYWdlfSk7XG4gICAgfSlcblxuICAgIC8v5Yib5bu6576k57uEXG4gICAgc29ja2V0Lm9uKCdjcmVhdGVHcm91cCcsIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgICBjb25zdCBncm91cCA9IGF3YWl0IGFwaUxpc3QuY3JlYXRlR3JvdXAoZGF0YSlcbiAgICAgICAgc29ja2V0LmpvaW4oZ3JvdXAuX2lkLCAoKSA9PiB7XG4gICAgICAgICAgICBzb2NrZXQuZW1pdCgnYWRkTGlua21hbicsIGdyb3VwKVxuICAgICAgICB9KVxuICAgIH0pXG4gICAgLy/liqDlhaXnvqTnu4RcbiAgICBzb2NrZXQub24oJ2pvaW5Hcm91cCcsIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhcGlMaXN0LmpvaW5Hcm91cChkYXRhKVxuICAgICAgICBjb25zb2xlLmxvZyhkYXRhKVxuICAgICAgICBzb2NrZXQuam9pbihkYXRhLmdyb3VwSWQsICgpID0+IHtcbiAgICAgICAgICAgIHNvY2tldC5lbWl0KCdhZGRMaW5rbWFuJywgcmVzdWx0KVxuICAgICAgICAgICAgc29ja2V0LmJyb2FkY2FzdC50byhkYXRhLmdyb3VwSWQpLmVtaXQoJ3NldEZvY3VzTWVzc2FnZScsIHttZXNzYWdlOiByZXN1bHQubWVzc2FnZX0pXG4gICAgICAgIH0pXG4gICAgfSlcbiAgICAvL+ino+aVo+e+pOe7hFxuICAgIHNvY2tldC5vbignZGVsR3JvdXAnLCBhc3luYyBkYXRhID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXBpTGlzdC5kZWxHcm91cChkYXRhKVxuICAgICAgICBpZiAocmVzdWx0LnN0YXR1cykge1xuICAgICAgICAgICAgc29ja2V0LmVtaXQoJ2RlbExpbmttYW4nLCByZXN1bHQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpby5zb2NrZXRzLmluKGRhdGEpLmVtaXQoJ2RlbExpbmttYW4nLCByZXN1bHQpXG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgLy/mn6Xmib7nvqTnu4TlkoznlKjmiLdcbiAgICBzb2NrZXQub24oJ3NlYXJjaExpbmttYW5zJywgYXN5bmMgZGF0YSA9PiB7XG4gICAgICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgYXBpTGlzdC5zZWFyY2hGcmllbmQoZGF0YSlcbiAgICAgICAgY29uc3QgZ3JvdXBzID0gYXdhaXQgYXBpTGlzdC5zZWFyY2hHcm91cChkYXRhKVxuICAgICAgICBzb2NrZXQuZW1pdCgnc2VhcmNoUmVzdWx0Jywge3VzZXJzLCBncm91cHN9KVxuICAgIH0pXG5cblxuICAgIHNvY2tldC5vbignZ2V0SGlzdG9yeU1lc3NhZ2VzJywgYXN5bmMgKGZvY3VzKSA9PiB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGZvY3VzKVxuICAgICAgICBpZiAoZm9jdXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gZm9jdXMuX2lkXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IGFwaUxpc3QuZ2V0SGlzdG9yeU1lc3NhZ2UoaWQpXG4gICAgICAgICAgICBzb2NrZXQuZW1pdCgnZ2V0SGlzdG9yeU1lc3NhZ2VzJywgbWVzc2FnZXMpXG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgc29ja2V0Lm9uKCdzZWFyY2hFeHByZXNzaW9uJywgYXN5bmMga2V5d29yZCA9PiB7XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFwaUxpc3QuZ2V0RXhwcmVzc2lvbihrZXl3b3JkKVxuICAgICAgICBzb2NrZXQuZW1pdCgnZ2V0RXhwcmVzc2lvbicsIHJlcylcbiAgICB9KVxuXG4gICAgc29ja2V0Lm9uKCdnZXRHcm91cE1lbWJlcnMnLCBhc3luYyBuYW1lID0+IHtcbiAgICAgICAgY29uc3QgbWVtYmVycyA9IGF3YWl0IGFwaUxpc3QuZ2V0R3JvdXBNZW1iZXJzKG5hbWUpXG4gICAgICAgIG1lbWJlcnMgJiYgc29ja2V0LmVtaXQoJ3NldEdyb3VwTWVtYmVycycsIG1lbWJlcnMpXG4gICAgfSlcblxuICAgIHNvY2tldC5vbignZGlzY29ubmVjdCcsICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2Rpc2Nvbm5lY3QnKVxuICAgIH0pXG59KVxuc2VydmVyLmxpc3RlbigzMDAwLCAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ+acjeWKoeWZqOWcqDMwMDDlkK/liqgnKVxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gYXBwO1xuXG4iXX0=